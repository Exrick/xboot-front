webpackJsonp([10],{"0BD8":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=s("3cXf"),o=s.n(r),a={name:"user-manage",data:function(){var e=this;return{loading:!0,drop:!1,dropDownContent:"展开",dropDownIcon:"chevron-down",selectCount:0,selectList:[],searchForm:{username:"",mobile:"",email:"",sex:"",type:"",status:"",pageNumber:1,pageSize:10,sort:"createTime"},modalType:0,userModalVisible:!1,modalTitle:"",userForm:{sex:1,roles:[]},userRoles:[],roleList:[],errorPass:"",userFormValidate:{username:[{required:!0,message:"账号不能为空",trigger:"blur"}],mobile:[{required:!0,message:"手机号不能为空",trigger:"blur"},{validator:function(e,t,s){/^[1][3,4,5,7,8][0-9]{9}$/.test(t)?s():s(new Error("手机号格式错误"))},trigger:"blur"}],email:[{required:!0,message:"请输入邮箱地址"},{type:"email",message:"邮箱格式不正确"}]},submitLoading:!1,columns:[{type:"selection",width:60,align:"center"},{title:"用户名",key:"username",sortable:!0},{title:"手机",key:"mobile",sortable:!0},{title:"邮箱",key:"email",sortable:!0},{title:"性别",key:"sex",width:70,align:"center",render:function(e,t){var s="";return 1===t.row.sex?s="男":0===t.row.sex&&(s="女"),e("div",s)}},{title:"用户类型",key:"type",align:"center",render:function(e,t){var s="";return 1===t.row.type?s="管理员":0===t.row.type&&(s="普通用户"),e("div",s)}},{title:"状态",key:"status",align:"center",render:function(e,t){return 0===t.row.status?e("div",[e("Tag",{props:{type:"dot",color:"green"}},"正常启用")]):-1===t.row.status?e("div",[e("Tag",{props:{type:"dot",color:"red"}},"禁用")]):void 0},filters:[{label:"正常启用",value:0},{label:"禁用",value:-1}],filterMultiple:!1,filterMethod:function(e,t){return 0===e?0===t.status:-1===e?-1===t.status:void 0}},{title:"创建时间",key:"createTime",sortable:!0},{title:"操作",key:"action",width:220,align:"center",render:function(t,s){return 0===s.row.status?t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.edit(s.row)}}},"编辑"),t("Button",{props:{type:"ghost",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.disable(s.row)}}},"禁用"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.remove(s.row)}}},"删除")]):t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.edit(s.row)}}},"编辑"),t("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.enable(s.row)}}},"启用"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.remove(s.row)}}},"删除")])}}],data:[],exportData:[],total:0}},methods:{init:function(){this.getUserList()},changePage:function(e){this.searchForm.pageNumber=e,this.getUserList()},changePageSize:function(e){this.searchForm.pageSize=e,this.getUserList()},getUserList:function(){var e=this;this.loading=!0,this.getRequest("/user/getByCondition",this.searchForm).then(function(t){e.loading=!1,!0===t.success&&(e.data=t.result.content,e.total=t.result.totalElements)})},handleSearch:function(){this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.init()},handleReset:function(){this.$refs.searchForm.resetFields(),this.searchForm.pageNumber=1,this.searchForm.pageSize=10,this.init()},getRoleList:function(){var e=this;this.getRequest("/role/getAllList").then(function(t){!0===t.success&&(e.roleList=t.result)})},handleDropdown:function(e){var t=this;this.selectCount<=0?this.$Message.warning("您还未选择要导出的数据"):"exportData"===e&&this.$Modal.confirm({title:"确认导出",content:"您确认要导出所选 "+this.selectCount+" 条数据?",onOk:function(){t.$refs.exportTable.exportCsv({filename:"用户数据"})}})},selectRoles:function(e){},cancelUser:function(){this.userModalVisible=!1},submitUser:function(){var e=this;this.$refs.userForm.validate(function(t){if(t){var s="/user/admin/add";if(1===e.modalType&&(s="/user/edit"),0===e.modalType&&e.userForm.password.length<6)return void(e.errorPass="密码不能为空且长度不得少于6位");e.submitLoading=!0,e.postRequest(s,e.userForm).then(function(t){e.submitLoading=!1,!0===t.success&&(e.$Message.success("操作成功"),e.init(),e.userModalVisible=!1)})}})},addUser:function(){this.modalType=0,this.modalTitle="添加用户",this.userForm={sex:1,roles:[]},this.userModalVisible=!0},edit:function(e){for(var t in this.modalType=1,this.modalTitle="编辑用户",e)null===e[t]&&(e[t]="");var s=o()(e),r=JSON.parse(s);this.userForm=r;var a=[];this.userForm.roles.forEach(function(e){a.push(e.id)}),this.userForm.roles=a,this.userModalVisible=!0},enable:function(e){var t=this;this.$Modal.confirm({title:"确认启用",content:"您确认要启用用户 "+e.username+" ?",onOk:function(){t.postRequest("/user/admin/enable",{userId:e.id}).then(function(e){!0===e.success&&(t.$Message.success("操作成功"),t.init())})}})},disable:function(e){var t=this;this.$Modal.confirm({title:"确认禁用",content:"您确认要禁用用户 "+e.username+" ?",onOk:function(){t.postRequest("/user/admin/disable",{userId:e.id}).then(function(e){!0===e.success&&(t.$Message.success("操作成功"),t.init())})}})},remove:function(e){var t=this;this.$Modal.confirm({title:"确认删除",content:"您确认要删除用户 "+e.username+" ?",onOk:function(){t.deleteRequest("/user/delByIds",{ids:e.id}).then(function(e){!0===e.success&&(t.$Message.success("删除成功"),t.init())})}})},dropDown:function(){this.drop?(this.dropDownContent="展开",this.dropDownIcon="chevron-down"):(this.dropDownContent="收起",this.dropDownIcon="chevron-up"),this.drop=!this.drop},showSelect:function(e){this.exportData=e,this.selectList=e,this.selectCount=e.length},clearSelectAll:function(){this.$refs.table.selectAll(!1)},delAll:function(){var e=this;this.selectCount<=0?this.$Message.warning("您还未选择要删除的数据"):this.$Modal.confirm({title:"确认删除",content:"您确认要删除所选的 "+this.selectCount+" 条数据?",onOk:function(){var t="";e.selectList.forEach(function(e){t+=e.id+","}),t=t.substring(0,t.length-1),e.deleteRequest("/user/delByIds",{ids:t}).then(function(t){!0===t.success&&(e.$Message.success("删除成功"),e.init())})}})}},mounted:function(){this.init(),this.getRoleList()}},i={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search"},[s("Row",[s("Col",[s("Card",[s("Row",[s("Form",{ref:"searchForm",staticClass:"search-form",attrs:{model:e.searchForm,inline:"","label-width":70}},[s("Form-item",{attrs:{label:"用户名称",prop:"username"}},[s("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入用户名"},model:{value:e.searchForm.username,callback:function(t){e.$set(e.searchForm,"username",t)},expression:"searchForm.username"}})],1),e._v(" "),s("Form-item",{attrs:{label:"手机号",prop:"mobile"}},[s("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入手机号"},model:{value:e.searchForm.mobile,callback:function(t){e.$set(e.searchForm,"mobile",t)},expression:"searchForm.mobile"}})],1),e._v(" "),e.drop?s("span",[s("Form-item",{attrs:{label:"邮箱",prop:"email"}},[s("Input",{staticStyle:{width:"200px"},attrs:{type:"text",placeholder:"请输入邮箱"},model:{value:e.searchForm.email,callback:function(t){e.$set(e.searchForm,"email",t)},expression:"searchForm.email"}})],1),e._v(" "),s("Form-item",{attrs:{label:"性别",prop:"sex"}},[s("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:e.searchForm.sex,callback:function(t){e.$set(e.searchForm,"sex",t)},expression:"searchForm.sex"}},[s("Option",{attrs:{value:"0"}},[e._v("女")]),e._v(" "),s("Option",{attrs:{value:"1"}},[e._v("男")])],1)],1),e._v(" "),s("Form-item",{attrs:{label:"用户类型",prop:"type"}},[s("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:e.searchForm.type,callback:function(t){e.$set(e.searchForm,"type",t)},expression:"searchForm.type"}},[s("Option",{attrs:{value:"0"}},[e._v("普通用户")]),e._v(" "),s("Option",{attrs:{value:"1"}},[e._v("管理员")])],1)],1),e._v(" "),s("Form-item",{attrs:{label:"用户状态",prop:"status"}},[s("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择"},model:{value:e.searchForm.status,callback:function(t){e.$set(e.searchForm,"status",t)},expression:"searchForm.status"}},[s("Option",{attrs:{value:"0"}},[e._v("正常")]),e._v(" "),s("Option",{attrs:{value:"-1"}},[e._v("禁用")])],1)],1)],1):e._e(),e._v(" "),s("Form-item",{staticStyle:{"margin-left":"-35px"}},[s("Button",{attrs:{type:"primary",icon:"search"},on:{click:e.handleSearch}},[e._v("搜索")]),e._v(" "),s("Button",{attrs:{type:"ghost"},on:{click:e.handleReset}},[e._v("重置")]),e._v(" "),s("a",{staticClass:"drop-down",on:{click:e.dropDown}},[e._v(e._s(e.dropDownContent)+"\n                            "),s("Icon",{attrs:{type:e.dropDownIcon}})],1)],1)],1)],1),e._v(" "),s("Row",{staticClass:"operation"},[s("Button",{attrs:{type:"primary",icon:"plus-round"},on:{click:e.addUser}},[e._v("添加用户")]),e._v(" "),s("Button",{attrs:{type:"ghost",icon:"trash-a"},on:{click:e.delAll}},[e._v("批量删除")]),e._v(" "),s("Dropdown",{on:{"on-click":e.handleDropdown}},[s("Button",{attrs:{type:"ghost"}},[e._v("\n                          更多操作\n                          "),s("Icon",{attrs:{type:"arrow-down-b"}})],1),e._v(" "),s("DropdownMenu",{attrs:{slot:"list"},slot:"list"},[s("DropdownItem",{attrs:{name:"exportData"}},[e._v("导出所选数据")])],1)],1)],1),e._v(" "),s("Row",[s("Alert",{attrs:{"show-icon":""}},[e._v("\n                        已选择 "),s("span",{staticClass:"select-count"},[e._v(e._s(e.selectCount))]),e._v(" 项\n                        "),s("a",{staticClass:"select-clear",on:{click:e.clearSelectAll}},[e._v("清空")])])],1),e._v(" "),s("Row",{staticClass:"margin-top-10 searchable-table-con1"},[s("Table",{ref:"table",attrs:{loading:e.loading,border:"",columns:e.columns,data:e.data},on:{"on-selection-change":e.showSelect}}),e._v(" "),s("Table",{ref:"exportTable",staticStyle:{display:"none"},attrs:{columns:e.columns,data:e.exportData}})],1),e._v(" "),s("Row",{staticClass:"code-row-bg page",attrs:{type:"flex",justify:"end"}},[s("Page",{attrs:{current:this.searchForm.pageNumber,total:e.total,"page-size":this.searchForm.pageSize,"page-size-opts":[10,20,50,100],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1)],1)],1),e._v(" "),s("Modal",{attrs:{title:e.modalTitle,"mask-closable":!1,width:500},model:{value:e.userModalVisible,callback:function(t){e.userModalVisible=t},expression:"userModalVisible"}},[s("Form",{ref:"userForm",attrs:{model:e.userForm,"label-width":70,rules:e.userFormValidate}},[s("FormItem",{attrs:{label:"用户名",prop:"username"}},[s("Input",{model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username",t)},expression:"userForm.username"}})],1),e._v(" "),0===e.modalType?s("FormItem",{attrs:{label:"密码",prop:"password",error:e.errorPass}},[s("Input",{attrs:{type:"password"},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password",t)},expression:"userForm.password"}})],1):e._e(),e._v(" "),s("FormItem",{attrs:{label:"邮箱",prop:"email"}},[s("Input",{model:{value:e.userForm.email,callback:function(t){e.$set(e.userForm,"email",t)},expression:"userForm.email"}})],1),e._v(" "),s("FormItem",{attrs:{label:"手机号",prop:"mobile"}},[s("Input",{model:{value:e.userForm.mobile,callback:function(t){e.$set(e.userForm,"mobile",t)},expression:"userForm.mobile"}})],1),e._v(" "),s("FormItem",{attrs:{label:"性别"}},[s("RadioGroup",{model:{value:e.userForm.sex,callback:function(t){e.$set(e.userForm,"sex",t)},expression:"userForm.sex"}},[s("Radio",{attrs:{label:1}},[e._v("男")]),e._v(" "),s("Radio",{attrs:{label:0}},[e._v("女")])],1)],1),e._v(" "),s("FormItem",{attrs:{label:"用户类型"}},[s("Select",{attrs:{placeholder:"请选择"},model:{value:e.userForm.type,callback:function(t){e.$set(e.userForm,"type",t)},expression:"userForm.type"}},[s("Option",{attrs:{value:0}},[e._v("普通用户")]),e._v(" "),s("Option",{attrs:{value:1}},[e._v("管理员")])],1)],1),e._v(" "),s("FormItem",{attrs:{label:"角色分配"}},[s("Select",{attrs:{multiple:""},on:{"on-change":e.selectRoles},model:{value:e.userForm.roles,callback:function(t){e.$set(e.userForm,"roles",t)},expression:"userForm.roles"}},e._l(e.roleList,function(t){return s("Option",{key:t.id,attrs:{value:t.id}},[e._v(e._s(t.name))])}))],1)],1),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"text"},on:{click:e.cancelUser}},[e._v("取消")]),e._v(" "),s("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.submitUser}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]};var n=s("Z0/y")(a,i,!1,function(e){s("BP3N")},null,null);t.default=n.exports},BP3N:function(e,t){}});
//# sourceMappingURL=10.c25e067eb8d1c2419c77.js.map